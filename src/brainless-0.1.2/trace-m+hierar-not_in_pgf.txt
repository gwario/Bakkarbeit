m

	display-move
		move>string
			move>san
				is-string
					new-string
				append-move>san
					castle-move?
						get-move-class
							moves
					get-orig
						moves
					pawn?
					write-pawn-move-san
						capture-move?
							get-target
								moves
							empty?
							get-move-class
								moves
						get-target
							moves
						write-square
							write-square-file
								>xy
								write-char
									curr-char
										?in-string
											in-string?
									next-char
							write-square-rank
								>xy
								write-char
									curr-char
										?in-string
											in-string?
									next-char
						write-pawn-trans
							get-move-class
								moves
					write-check-state
						get-move
							moves
							move@
						do-move-undo-info
							remember-position
							hash-far-moved-pawn
								update-hash
							move-squares
							to-move-squares
							hash-square
								hash-piece
									update-hash
							do-normal-move
								(do-normal-move)
									undo-info
									take-piece
									put-piece
							other-party
							update-curr-check?
								opponent-move-target
								king-square
								threatens?
									get-piece-masked
									white-pawn-threatens?
								opponent-move-orig
								might-cause-check?
									king-square
									queenlike-threatens-through?
										>delta-xy
										bishop-xy?
										rook-xy?
							hash-far-moved-pawn
								update-hash
							opponent-move-target
							hash-square
								hash-piece
									update-hash
						moves-exist?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							my-piece?
							pawn-moves
								?direction
								pawn-far-move
									empty?
									?direction
									empty?
									(move-to-exists?)
										(move-to-exists?-nocheck)
											might-cause-check?
												king-square
												queenlike-threatens-through?
													>delta-xy
													bishop-xy?
													rook-xy?
								?direction
								pawn-normal-move
									empty?
									pawn-trans?
									(move-to-exists?)
								?direction
								pawn-strike-move
									opponent?
								strike-ep-move
									?direction
								?direction
								pawn-strike-move
									opponent?
								strike-ep-move
									?direction
						check?
							king-square
							threatened-by-opponent?
								opponent-pieces
								threatened-by-piece?
									threatened-by-pawn?
										?direction
										opponent-pawn?
											get-piece-masked
										?direction
										opponent-pawn?
											get-piece-masked
									threatened-by-knight?
										opponent-knight?
											get-piece-masked
										opponent-knight?
											get-piece-masked
										opponent-knight?
											get-piece-masked
										opponent-knight?
											get-piece-masked
										opponent-knight?
											get-piece-masked
										opponent-knight?
											get-piece-masked
										opponent-knight?
											get-piece-masked
										opponent-knight?
											get-piece-masked
									threatened-by-bishop?
										opponent-bishop?
										opponent-bishop?
										opponent-bishop?
										opponent-bishop?
									threatened-by-rook?
										opponent-rook?
										opponent-rook?
										opponent-rook?
										opponent-rook?
									threatened-by-king?
										opponent-king-square
						undo-move
							other-party
							to-move-squares
								undo-normal-move
									put-piece
									remove-piece
							forget-position
				#characters
				previous-string
	get-move
		moves
		move@
	do-move
		do-move-undo-info
			remember-position
			hash-far-moved-pawn
				update-hash
			move-squares
			to-move-squares
			hash-square
				hash-piece
					update-hash
			do-normal-move
				(do-normal-move)
					undo-info
					take-piece
					put-piece
			other-party
			update-curr-check?
				opponent-move-target
				king-square
				threatens?
					get-piece-masked
					white-pawn-threatens?
				opponent-move-orig
				might-cause-check?
					king-square
					queenlike-threatens-through?
						>delta-xy
						bishop-xy?
						rook-xy?
			hash-far-moved-pawn
				update-hash
			opponent-move-target
			hash-square
				hash-piece
					update-hash
	forget-moves
	hist-record
		?epd-append-to-file
			file-exists?
			epd-append-to-file
				epd-write-to-file
					position>epd
						is-string
							new-string
						epd-write-board
							epd-write-board-line
								>square
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
							epd-write-board-line
								>square
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
							epd-write-board-line
								>square
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								piece?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
							epd-write-board-line
								>square
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								piece?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
							epd-write-board-line
								>square
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								empty?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								piece?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
							epd-write-board-line
								>square
								empty?
								empty?
								empty?
								empty?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								empty?
								empty?
								empty?
								empty?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								piece?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
							epd-write-board-line
								>square
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								empty?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
							epd-write-board-line
								>square
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								piece>char
								write-char
									curr-char
									?in-string
									in-string?
									next-char
								empty?
								piece?
								write-char
									curr-char
									?in-string
									in-string?
									next-char
						epd-write-party
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
						epd-write-castle
							#characters
							white-piece
							unmoved
							white-piece
							unmoved
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							white-piece
							unmoved
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							black-piece
							unmoved
							black-piece
							unmoved
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							black-piece
							unmoved
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							#characters
							write-char
								curr-char
								?in-string
								in-string?
								next-char
						epd-write-ep
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
						write-string
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
							write-char
								curr-char
								?in-string
								in-string?
								next-char
						#characters
						previous-string
				epd-close-file
	look
		.board
			.hborder
			.board-line
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				.vborder-slice
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				.vborder-slice
			.board-line
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				.vborder-slice
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
						white-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
							field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							black-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				.vborder-slice
			.board-line
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				.vborder-slice
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				.vborder-slice
			.board-line
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				.vborder-slice
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				.vborder-slice
			.board-line
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				.vborder-slice
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				.vborder-slice
			.board-line
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				.vborder-slice
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				.vborder-slice
			.board-line
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				.vborder-slice
				.vborder-slice
				square-white?
				xy-board@
				>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				.vborder-slice
			.board-line
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
				.vborder-slice
				.vborder-slice
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							black-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							black-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							black-field-attr
						no-attr
				square-white?
				xy-board@
					>square
				.field-slice
					field-spaces
						field-attr
							white-field-attr
						no-attr
					.piece
						piece-attr
							white-piece-attr
								field-attr
							white-field-attr
						(.piece)
							piece>string
								piece>ascii
									piece>char
						no-attr
					field-spaces
						field-attr
							white-field-attr
						no-attr
				.vborder-slice
			.hborder
		.party
